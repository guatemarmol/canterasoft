<?php 	require  '../../../../vendor/autoload.php';		include_once '../../../on-database.php';	use PhpOffice\PhpSpreadsheet\IOFactory;    use PhpOffice\PhpSpreadsheet\Spreadsheet;    use PhpOffice\PhpSpreadsheet\Writer\Xlsx;    use PhpOffice\PhpSpreadsheet\Style\Fill;    use PhpOffice\PhpSpreadsheet\Style\Border;	use PhpOffice\PhpSpreadsheet\Reader\Xls;		$query = "SELECT imt.piloto, imt.numero_placa, cm.nombre, imt.peso, imt.hora, imt.hora_salida, TIMEDIFF(imt.hora_salida,imt.hora) AS intervalo FROM ingresoMateriaPrima AS imt INNER JOIN camion AS cm ON cm.placa = imt.numero_placa";										$result = mysqli_query($con, $query);$reader = IOFactory::createReader('Xlsx');$spreadsheet = $reader->load("../../../produccion/plantillas/PlantillaAcarreoPiedra.xlsx");    $styleArray = [        'borders' => [            'allBorders' => [                'borderStyle' => Border::BORDER_THIN,                'color' => ['rgb' => '000000'],            ],        ]    ];   $n = 1;   $i = 20;      while($s = mysqli_fetch_row($result)){        $sheet->fromArray([$n,$s[0],$s[1],$s[2],$s[3],$s[4],$s[5],$s[6]], NULL, 'A'.$i);        $sheet->getStyle('A'.$i.':H'.$i)->applyFromArray($styleArray);        $i++;		$n++;    }       foreach (range('A','H') as $col) {        $sheet->getColumnDimension($col)->setAutoSize(true);      }    $sheet->getStyle('A:H')->getAlignment()->setHorizontal('center');            $writer = new Xlsx($spreadsheet);    $writer->save('AcarreoPiedra.xlsx');    echo 'AcarreoPiedra.xlsx';